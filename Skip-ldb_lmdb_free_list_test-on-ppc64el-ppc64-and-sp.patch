From eb5409dd5e4dde482935421ce0eddf88a0d2d2f4 Mon Sep 17 00:00:00 2001
From: Mathieu Parent <math.parent@gmail.com>
Date: Thu, 25 Jun 2020 15:15:40 +0200
Subject: [PATCH] Skip ldb_lmdb_free_list_test on alpha, ia64, mips64el, ppc64el, ppc64 and sparc64

Workaround: https://bugzilla.samba.org/show_bug.cgi?id=14404
---
 wscript | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff -ruNa ldb-2.1.4/wscript ldb-2.1.4-org/wscript
--- ldb-2.1.4/wscript   2021-03-23 11:14:55.530512420 +0800
+++ ldb-2.1.4-org/wscript       2020-06-25 16:43:52.000000000 +0800
@@ -635,8 +635,9 @@
                      # fit > 4G of data into the DB), it would fill up the disk on
                      # many of our test instances
                      'ldb_mdb_kv_ops_test',
+                     'ldb_key_value_sub_txn_mdb_test']
+        if os.environ.get('DEB_HOST_ARCH', 'unknown') not in ['alpha', 'ia64', 'mips64el', 'ppc64el', 'ppc64', 'sparc64', 'unknown']:
+            test_exes += ['ldb_lmdb_free_list_test']
-                     'ldb_key_value_sub_txn_mdb_test',
-                     'ldb_lmdb_free_list_test']
     else:
         test_exes += ['ldb_no_lmdb_test']

--
2.26.2
